---
title: "Explore extraction results"
format: gfm
---


```{python}
import pandas as pd
from pathlib import Path
import os

# Get the base directory (parent of notebooks folder)
base_dir = Path.cwd().parent if Path.cwd().name == "notebooks" else Path.cwd()

# Check if data/extracted directory exists
extracted_dir = base_dir / "data/extracted"
dfs = []
for f in os.listdir(extracted_dir):
    if f.endswith('.parquet'):
        df = pd.read_parquet(extracted_dir / f)
        dfs.append(df)
    
df_final = pd.concat(dfs, ignore_index=True)
df_final.to_parquet(base_dir / "data/extracted_sample_10.parquet", index=False)
```


```{python}
df_success_time = (
    df_final
    .groupby('model_name')
    .agg(
        n = ('success', 'count'),
        success_rate = ('success', 'mean'),
        avg_extraction_time_seconds = ('extraction_time_seconds', 'mean')
    )
    .reset_index()
    .sort_values('success_rate', ascending=False)
)

df_success_time
```
